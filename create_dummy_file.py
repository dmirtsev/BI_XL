import pandas as pd
import numpy as np

def create_dummy_excel():
    """
    Создает тестовый Excel-файл 'dummy_orders.xlsx' с данными,
    включая пустые значения для проверки обработки NaN.
    """
    data = {
        "Идентификатор": [1, 2, 3, 4],
        "Номер": ["A-101", "B-202", "C-303", "D-404"],
        "Имя контакта": ["Иван", "Петр", "Анна", "Мария"],
        "Фамилия контакта": ["Иванов", "Петров", "Сидорова", "Кузнецова"],
        "Email контакта": ["ivan@test.com", "petr@test.com", "anna@test.com", "maria@test.com"],
        "Ответственный": ["Менеджер 1", "Менеджер 2", "Менеджер 1", "Менеджер 3"],
        "Содержимое": ["Товар 1", "Товар 2", "Товар 3", "Товар 4"],
        "Статус": ["Новый", "В работе", "Завершен", "Отменен"],
        "Общая сумма": [1000.0, 2500.50, 500.0, 1200.75],
        "Оплаченная сумма": [1000.0, 1000.0, 500.0, 0.0],
        "Дата создания": pd.to_datetime(["2023-01-10", "2023-01-11", "2023-01-12", "2023-01-13"]),
        "Дата оплаты": pd.to_datetime(["2023-01-11", "2023-01-12", "2023-01-13", pd.NaT]),
        "Валюта": ["RUB", "RUB", "USD", "RUB"],
        "Теги": ["#vip", "#срочно", "", "#возврат"],
        "Сумма скидки": [0, 100, 0, 50],
        "Доход": [800, 2000, 400, 0],
        "Комиссия": [200, 400, 100, 0],
        "Идентификатор партнера": ["P1", "P2", "", "P1"],
        "Email партнера": ["partner1@test.com", "partner2@test.com", "", "partner1@test.com"],
        "Комиссия партнера": [10.0, 15.0, 0.0, 5.0],
        "Телефон контакта": ["+79991112233", "+79994445566", "+79997778899", "+79990001122"],
        # Здесь ключевой момент: одно из значений пустое (NaN)
        "Идентификатор контакта": [123, 456, np.nan, 789],
        "UTM Campaign": ["promo1", "promo2", "promo1", "promo3"],
        "UTM Content": ["banner", "email", "banner", "cpc"],
        "UTM Medium": ["cpc", "email", "cpc", "cpc"],
        "UTM Source": ["google", "newsletter", "yandex", "google"],
        "UTM Term": ["buy_now", "sale", "discount", "new_offer"],
        "Дата заказа в ГК": pd.to_datetime(["2023-01-10", "2023-01-11", pd.NaT, "2023-01-13"]),
    }
    df = pd.DataFrame(data)
    
    # Сохраняем в Excel-файл
    file_path = "dummy_orders.xlsx"
    df.to_excel(file_path, index=False, engine='openpyxl')
    print(f"Файл '{file_path}' успешно создан.")

if __name__ == "__main__":
    create_dummy_excel()
